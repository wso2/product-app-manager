<?xml version="1.0" encoding="UTF-8"?>
<Module>

<ModulePrefs
title="Countdown"
height="55"
author="Sean Regan"
author_email="sregan@gmail.com"
author_location="Sunnyvale, CA"
directory_title="Countdown" 
description="Simple live event countdown gadget"
author_affiliation="seanregan.com" 
screenshot="http://seanregan.com/countdown/countdown.png" 
thumbnail="http://seanregan.com/countdown/countdown_small.png" 
category="technology" 
/>
<UserPref name="event" display_name="Event" required="true" />
<UserPref name="event_year"  required="true"
     display_name="Year"
     datatype="enum">
  <EnumValue value="2009" display_value="2009"/>
  <EnumValue value="2010" display_value="2010"/>
  <EnumValue value="2011" display_value="2011"/>
  <EnumValue value="2012" display_value="2012"/>
  <EnumValue value="2013" display_value="2013"/>
  <EnumValue value="2014" display_value="2014"/>
  <EnumValue value="2015" display_value="2015"/>
  <EnumValue value="2016" display_value="2016"/>
  <EnumValue value="2017" display_value="2017"/>
  <EnumValue value="2018" display_value="2018"/>
  <EnumValue value="2019" display_value="2019"/>
  <EnumValue value="2020" display_value="2020"/>
  <EnumValue value="2021" display_value="2021"/>
  <EnumValue value="2022" display_value="2022"/>
  <EnumValue value="2023" display_value="2023"/>
  <EnumValue value="2024" display_value="2024"/>
  <EnumValue value="2025" display_value="2025"/>
</UserPref>

<UserPref name="event_month"  required="true"
     display_name="Month"
     datatype="enum">
  <EnumValue value="0" display_value="January"/>
  <EnumValue value="1" display_value="February"/>
  <EnumValue value="2" display_value="March"/>
  <EnumValue value="3" display_value="April"/>
  <EnumValue value="4" display_value="May"/>
  <EnumValue value="5" display_value="June"/>
  <EnumValue value="6" display_value="July"/>
  <EnumValue value="7" display_value="August"/>

  <EnumValue value="8" display_value="September"/>
  <EnumValue value="9" display_value="October"/>
  <EnumValue value="10" display_value="November"/>
  <EnumValue value="11" display_value="December"/>
</UserPref>
<UserPref name="event_day"  required="true"
     display_name="Day"
     datatype="enum">
  <EnumValue value="1"/>
  <EnumValue value="2"/>
  <EnumValue value="3"/>
  <EnumValue value="4"/>

  <EnumValue value="5"/>
  <EnumValue value="6"/>
  <EnumValue value="7"/>
  <EnumValue value="8"/>
  <EnumValue value="9"/>
  <EnumValue value="10"/>
  <EnumValue value="11"/>
  <EnumValue value="12"/>
  <EnumValue value="13"/>

  <EnumValue value="14"/>
  <EnumValue value="15"/>
  <EnumValue value="16"/>
  <EnumValue value="17"/>
  <EnumValue value="18"/>
  <EnumValue value="19"/>
  <EnumValue value="20"/>
  <EnumValue value="21"/>
  <EnumValue value="22"/>

  <EnumValue value="23"/>
  <EnumValue value="24"/>
  <EnumValue value="25"/>
  <EnumValue value="26"/>
  <EnumValue value="27"/>
  <EnumValue value="28"/>
  <EnumValue value="29"/>
  <EnumValue value="30"/>
  <EnumValue value="31"/>

</UserPref>
<UserPref name="event_hour"  required="true"
     display_name="Hour"
     datatype="enum">
  <EnumValue value="0" display_value="12 a.m."/>
  <EnumValue value="1" display_value="1 a.m."/>
  <EnumValue value="2" display_value="2 a.m."/>
  <EnumValue value="3" display_value="3 a.m."/>
  <EnumValue value="4" display_value="4 a.m."/>
  <EnumValue value="5" display_value="5 a.m."/>
  <EnumValue value="6" display_value="6 a.m."/>
  <EnumValue value="7" display_value="7 a.m."/>

  <EnumValue value="8" display_value="8 a.m."/>
  <EnumValue value="9" display_value="9 a.m."/>
  <EnumValue value="10" display_value="10 a.m."/>
  <EnumValue value="11" display_value="11 a.m."/>
  <EnumValue value="12" display_value="12 p.m."/>
  <EnumValue value="13" display_value="1 p.m."/>
  <EnumValue value="14" display_value="2 p.m."/>
  <EnumValue value="15" display_value="3 p.m."/>
  <EnumValue value="16" display_value="4 p.m."/>

  <EnumValue value="17" display_value="5 p.m."/>
  <EnumValue value="18" display_value="6 p.m."/>
  <EnumValue value="19" display_value="7 p.m."/>
  <EnumValue value="20" display_value="8 p.m."/>
  <EnumValue value="21" display_value="9 p.m."/>
  <EnumValue value="22" display_value="10 p.m."/>
  <EnumValue value="23" display_value="11 p.m."/>
</UserPref>
<UserPref name="event_minute"  required="true"
     display_name="Minute"
     datatype="enum">
  <EnumValue value="0"/>

  <EnumValue value="1"/>
  <EnumValue value="2"/>
  <EnumValue value="3"/>
  <EnumValue value="4"/>
  <EnumValue value="5"/>
  <EnumValue value="6"/>
  <EnumValue value="7"/>
  <EnumValue value="8"/>
  <EnumValue value="9"/>

  <EnumValue value="10"/>
  <EnumValue value="11"/>
  <EnumValue value="12"/>
  <EnumValue value="13"/>
  <EnumValue value="14"/>
  <EnumValue value="15"/>
  <EnumValue value="16"/>
  <EnumValue value="17"/>
  <EnumValue value="18"/>

  <EnumValue value="19"/>
  <EnumValue value="20"/>
  <EnumValue value="21"/>
  <EnumValue value="22"/>
  <EnumValue value="23"/>
  <EnumValue value="24"/>
  <EnumValue value="25"/>
  <EnumValue value="26"/>
  <EnumValue value="27"/>

  <EnumValue value="28"/>
  <EnumValue value="29"/>
  <EnumValue value="30"/>
  <EnumValue value="31"/>
  <EnumValue value="32"/>
  <EnumValue value="33"/>
  <EnumValue value="34"/>
  <EnumValue value="35"/>
  <EnumValue value="36"/>

  <EnumValue value="37"/>
  <EnumValue value="38"/>
  <EnumValue value="39"/>
  <EnumValue value="40"/>
  <EnumValue value="41"/>
  <EnumValue value="42"/>
  <EnumValue value="43"/>
  <EnumValue value="44"/>
  <EnumValue value="45"/>

  <EnumValue value="46"/>
  <EnumValue value="47"/>
  <EnumValue value="48"/>
  <EnumValue value="49"/>
  <EnumValue value="50"/>
  <EnumValue value="51"/>
  <EnumValue value="52"/>
  <EnumValue value="53"/>
  <EnumValue value="54"/>

  <EnumValue value="55"/>
  <EnumValue value="56"/>
  <EnumValue value="57"/>
  <EnumValue value="58"/>
  <EnumValue value="59"/>
</UserPref>
<UserPref name="font"
     display_name="Font"
     datatype="enum"
     default_value="Georgia">
  <EnumValue value="Georgia"/>
  <EnumValue value="Tahoma"/>
  <EnumValue value="Verdana"/>

  <EnumValue value="Arial"/>
  <EnumValue value="Courier New"/>
</UserPref>

<UserPref name="showWeeks" display_name="Show Weeks" datatype="bool" default_value="true"/>

<Content type="html"><![CDATA[
<style>
	div {
		float: left;
		text-align: center;
                width: 20%;
	}
	
	div h1, div h2 {
		font-family: __UP_font__;
		font-size: 2em;
		text-align: center;
		width: 100%;
		margin: 0;
		padding: 0;
	}
	
	div h2 {
		font-size: .75em;
		color: #AAA;
	}
</style>
<script type="text/javascript">
        var prefs = new _IG_Prefs();
	var eventYear = prefs.getInt("event_year");
	var eventMonth = prefs.getInt("event_month");
	var eventDay = prefs.getInt("event_day");
	var eventHour = prefs.getInt("event_hour");
	var eventMinute = prefs.getInt("event_minute");
	
	var eventDate = new Date(eventYear, eventMonth, eventDay, eventHour, eventMinute, 0);
	var nowDate = new Date();
	var remainingSeconds = Math.ceil((eventDate.getTime() - nowDate.getTime()) / 1000);

	var weekNum, weekTitle;
	var dayNum, dayTitle;
	var hourNum, hourTitle;
	var minuteNum, minuteTitle;
	var secondNum, secondTitle;
	
        function handle_resize()
        {
          if(__UP_showWeeks__ == true && window.innerWidth < 265)
          {
            document.getElementById('second').style.display = 'none';        
            document.getElementById('week').style.width = '25%';
            document.getElementById('day').style.width = '25%';
            document.getElementById('hour').style.width = '25%';
            document.getElementById('minute').style.width = '25%';
          }
          else
          {
		if(__UP_showWeeks__ == true) divWidth = '20%';
		else divWidth = '25%';
            document.getElementById('second').style.display = 'inline';
		document.getElementById('second').style.width = divWidth;
            document.getElementById('week').style.width = divWidth;
            document.getElementById('day').style.width = divWidth;
            document.getElementById('hour').style.width = divWidth;
            document.getElementById('minute').style.width = divWidth;
          }
        }

	function init()
	{
                if (window.addEventListener) window.addEventListener('resize', handle_resize, false);
		weekNum = document.getElementById('week').getElementsByTagName('h1')[0];
		weekTitle = document.getElementById('week').getElementsByTagName('h2')[0];	
		if(__UP_showWeeks__ == false) {
			document.getElementById('week').style.display = 'none';
		}
		dayNum = document.getElementById('day').getElementsByTagName('h1')[0];
		dayTitle = document.getElementById('day').getElementsByTagName('h2')[0];
		
		hourNum = document.getElementById('hour').getElementsByTagName('h1')[0];
		hourTitle = document.getElementById('hour').getElementsByTagName('h2')[0];
		
		minuteNum = document.getElementById('minute').getElementsByTagName('h1')[0];
		minuteTitle = document.getElementById('minute').getElementsByTagName('h2')[0];
		
		secondNum = document.getElementById('second').getElementsByTagName('h1')[0];
		secondTitle = document.getElementById('second').getElementsByTagName('h2')[0];
		
                handle_resize();
		setInterval("update_countdown()", 250);
	}
	function update_countdown() {
		remainingSeconds -= .25;
		var tmpSeconds = remainingSeconds;
		if(__UP_showWeeks__ == true) {	
			remainingWeeks = Math.max(0, Math.floor(tmpSeconds / (86400 * 7)));
			tmpSeconds -= remainingWeeks * 7 * 86400;
			weekNum.innerHTML = remainingWeeks;
			weekTitle.innerHTML = remainingWeeks == 1 ? 'Week' : 'Weeks'
		}
		
		remainingDays = Math.max(0, Math.floor(tmpSeconds / 86400));
		tmpSeconds -= remainingDays * 86400;
		dayNum.innerHTML = remainingDays;
		dayTitle.innerHTML = remainingDays == 1 ? 'Day' : 'Days'
		
		remainingHours = Math.max(0, Math.floor(tmpSeconds / 3600));
		tmpSeconds -= remainingHours * 3600;
		hourNum.innerHTML = remainingHours;
		hourTitle.innerHTML = remainingHours == 1 ? 'Hour' : 'Hours'
		
		remainingMinutes = Math.max(0, Math.floor(tmpSeconds / 60));
		tmpSeconds -= remainingMinutes * 60;
		minuteNum.innerHTML = remainingMinutes;
		minuteTitle.innerHTML = remainingMinutes == 1 ? 'Minute' : 'Minutes'
		
	
		tmpSeconds = Math.max(0, Math.floor(tmpSeconds));
		secondNum.innerHTML = tmpSeconds;
		secondTitle.innerHTML = tmpSeconds == 1 ? 'Second' : 'Seconds'

		if(Math.floor(tmpSeconds) % 5 == 0) {
			eventDate = new Date(eventYear, eventMonth, eventDay, eventHour, eventMinute, 0);
			nowDate = new Date();
			remainingSeconds = Math.ceil((eventDate.getTime() - nowDate.getTime()) / 1000);
		}
	}
</script>
<div id="week">
	<h1>&nbsp;</h1>
	<h2>Weeks</h2>
</div>

<div id="day">
	<h1>&nbsp;</h1>
	<h2>Days</h2>
</div>

<div id="hour">
	<h1>&nbsp;</h1>
	<h2>Hours</h2>
</div>

<div id="minute">
	<h1>&nbsp;</h1>
	<h2>Minutes</h2>
</div>

<div id="second">
	<h1>&nbsp;</h1>
	<h2>Seconds</h2>
</div>
<script type="text/javascript">init()</script>

]]></Content>
</Module>

